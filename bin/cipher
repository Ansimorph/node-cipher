#!/usr/bin/env node

var yargs = require('yargs');

var nodecipher = require('../');
var defaults = require('../lib/defaults');

/**
 * Command line interface.
 */
var argv = yargs
  .usage('Usage: $0 <command> -i [string] -o [string] -k [string] -a [string]')
  .command('encrypt', 'Encrypt the given input file')
  .command('decrypt', 'Decrypt the given input file')
  .demand(1)
  .demand(['i','o'])
  .describe('i', 'The path to the input file')
  .describe('o', 'The path to the output file')
  .describe('p', 'The encryption password')
  .describe('a', 'The encryption algorithm to use')
  .alias('i', 'input')
  .alias('o', 'output')
  .alias('p', 'password')
  .alias('a', 'algorithm')
  .alias('h', 'help')
  .default({ a: defaults.algorithm })
  .help('h')
  .argv;

/**
 * Perform the encryption or decryption process.
 */
nodecipher[argv._[0]]({
  input: argv.input,
  output: argv.output,
  password: argv.password || undefined,
  algorithm: argv.algorithm
});
